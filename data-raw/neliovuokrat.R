#### Asuntojen vuokratiedot ##############

library(pxweb)

data <- pxweb_interactive()

# PXWEB query
pxweb_query_list <-
  list("Vuosineljännes"=c("2015Q1"),
       "Alue"=c("ksu","pks","msu","A01","A02","A04","A05","A06","A07","A08","A09","A10","A11","A12","A13","A14","A15","A16","A17","A18","A19","091","091-1","091-2","091-3","091-4","049","049-1","049-2","049-3","092","092-1","092-2","sat","638","837","837-1","837-2","837-3","853","853-1","853-2","853-3","609","609-1","609-2","684","405","405-1","405-2","285","285-1","285-2","286","398","398-1","398-2","109","109-1","109-2","297","297-1","297-2","179","179-1","179-2","905","905-1","905-2","743","272","491","167","167-1","167-2","564","564-1","564-2","205","698","106","694","186","245"),
       "Huoneluku"=c("00","01","02","03"),
       "Rahoitusmuoto"=c("2","1","0"),
       "Tiedot"=c("ketj_Tor","keskivuokra"))

# Download data
px_data <-
  pxweb_get(url = "http://pxnet2.stat.fi/PXWeb/api/v1/fi/StatFin/asu/asvu/statfin_asvu_pxt_11x4.px",
            query = pxweb_query_list)

# Convert to data.frame
px_data <- as.data.frame(px_data, column.name.type = "text", variable.value.type = "text")

Espoo_Kauniainen_1 <- c(02100, 02110, 02120, 02130, 02160, 02170, 02180, 02330, 02380, 02700)
Espoo_Kauniainen_2 <- c(02140, 02150, 02200, 02230, 02240, 02270, 02280, 02300, 02340, 02600, 02610, 02630, 02650, 02660, 02680, 02730, 02740, 02750)
Espoo_Kauniainen_3 <- c(02210, 02260, 02290, 02320, 02360, 02620, 02710, 02720, 02760, 02770, 02780, 02810, 02820, 02860, 02920, 02940, 02970, 02980)
Helsinki_1 <- c(00100, 00120, 00130, 00140, 00150, 00160, 00170, 00180, 00220, 00260)
Helsinki_2 <- c(00200, 00210, 00250, 00270, 00280, 00290, 00300, 00310, 00320, 00330, 00340, 00500, 00510, 00520, 00530, 00540, 00550, 00560, 00570, 00580, 00590, 00610, 00810, 00850, 00990)
Helsinki_3 <- c(00240, 00350, 00360, 00370, 00400, 00430, 00440, 00620, 00650, 00660, 00670, 00680, 00690, 00730, 00780, 00790, 00800, 00830, 00840, 00950)
Helsinki_4 <- c(00190, 00230, 00380, 00390, 00410, 00420, 00600, 00630, 00640, 00700, 00710, 00720, 00740, 00750, 00760, 00770, 00820, 00860, 00870, 00880, 00890, 00900, 00910, 00920, 00930, 00940, 00960, 00970, 00980)
Hameenlinna_1 <- c(13100, 13130, 13200, 13220, 13270)
Hameenlinna_2 <- c(13110, 13210, 13250, 13300, 13430, 13500, 13530, 13600, 14300, 14330, 14370, 14450, 14500, 14680, 14690, 14700, 14770, 14810, 14820, 14840, 14870, 14930, 16900, 16960, 16970, 16980)
Joensuu_1 <- c(80100, 80110, 80200, 80220)
Joensuu_2 <- c(80130, 80140, 80160, 80170, 80230, 80260, 80330, 82220)
Joensuu_3 <- c(80210, 81200, 81210, 81260, 81270, 81280, 81290, 81295, 81320, 81330, 81360, 81390, 82110, 82120, 82140, 82160, 82170, 82180, 82200, 82210, 82710, 82730, 82750, 82760, 82815, 82840, 82850, 82865, 82870, 82880)
Jyvaskyla_1 <- c(40100, 40200, 40500, 40520, 40530, 40600, 40700, 40720)
Jyvaskyla_2 <- c(40250, 40270, 40320, 40340, 40400, 40420, 40620, 40630, 40640, 40660, 40740, 40800, 40820, 40900, 41120, 41140, 41160, 41450, 41630, 41800, 41820, 41840, 41860, 41870, 41880, 41930, 41940)
Kotka_1 <- c(48100,48210,48310, 48710)
Kotka_2 <- c(46930, 48130, 48200, 48220, 48230, 48300, 48350, 48400, 48410, 48600, 48700, 48720, 48750, 48770, 48800, 48810, 48900, 48910, 48930, 49300, 49340)
Kuopio_1 <- c(70100, 70110, 70300, 70600, 70800, 70840)
Kuopio_2 <- c(70150, 70200, 70280, 70300, 70340, 70400, 70420, 70460, 70500, 70620, 70700, 70780, 70820)
Kuopio_3 <- c(70210, 70240, 70260, 70870, 70940, 71130, 71150, 71160, 71310, 71330, 71360, 71380, 71480, 71490, 71520, 71570, 71610, 71650, 72100, 72140)
Lahti_1 <- c(15100, 15110, 15140, 15160, 15320, 15340, 15610, 15850, 15900)
Lahti_2 <- c(15150, 15170, 15200, 15210, 15230, 15240, 15300, 15500, 15520, 15680, 15700, 15800, 15810, 15830, 15840, 15950)
Lappeenranta_1 <- c(53100, 53130, 53500, 53600, 53900, 55330)
Lappeenranta_2 <- c(53200, 53300, 53400, 53420, 53650, 53810, 53830, 53850, 53920, 53950, 54100, 54110, 54120, 54190, 54230, 54250, 54270, 54310, 54330, 54390, 54410, 54430, 54460, 55300, 55320)
Mikkeli_1 <- c(50100, 50130, 50170, 50180, 50190, 50500, 50600)
Mikkeli_2 <- c(50120, 50150, 50160, 50350, 50520, 50670, 50770, 50970, 51130, 51420, 51450, 51520, 51540, 51600, 51620, 51670, 51720, 51740, 52100, 52110, 52150, 77380)
Oulu_1 <- c(90100, 90120, 90130, 90140, 90230, 90400, 90410, 90420, 90510)
Oulu_2 <- c(90150, 90220, 90240, 90250, 90310, 90500, 90520, 90530, 90540, 90550, 90560, 90570, 90580, 90590, 90620, 90630, 90650, 90660, 90670, 90800, 91300, 91310)
Pori_1 <- c(28100, 28130, 28300, 28430, 28540, 28660, 28900)
Pori_2 <- c(28120, 28190, 28200, 28220, 28240, 28330, 28360, 28370, 28500, 28560, 28580, 28600, 28610, 28760, 28800, 28840, 28880, 29570, 29600, 29680, 29700, 29720, 29570)
Tampere_1 <- c(33100, 33180, 33200, 33210, 33230, 33240, 33250, 33500, 33540)
Tampere_2 <- c(33270, 33400, 33530, 33560, 33610, 33710, 33730, 33820, 33900, 34240)
Tampere_3 <- c(33300, 33310, 33330, 33340, 33410, 33420, 33520, 33580, 33680, 33710, 33720, 33800, 33840, 33850, 33870, 34260, 34270)
Turku_1 <- c(20100, 20500, 20700, 20810, 20900)
Turku_2 <- c(20200, 20250, 20300, 20380, 20400, 20520, 20720, 20880, 20960)
Turku_3 <- c(20210, 20240, 20320, 20360, 20460, 20540, 20610, 20730, 20740, 20750, 20800, 21330, 21340)
Vantaa_1 <- c(01300, 01370, 01380, 01390, 01400, 01510, 01520, 01630, 01640, 01670, 01680, 01690, 01700)
Vantaa_2 <- c(01200, 01230, 01260, 01280, 01350, 01360, 01420, 01450, 01480, 01490, 01530, 01600, 01610, 01620, 01650, 01660, 01710, 01720, 01730, 01740, 01750, 01760, 01770)
Vaasa_1 <- c(65100, 65170, 65200, 65410)
Vaasa_2 <- c(65130, 65230, 65280, 65300, 65320, 65350, 65370, 65380)

aluejako <- data.frame(Alue = c(rep("Espoo-Kauniainen 1", length(Espoo_Kauniainen_1)),
                                rep("Espoo-Kauniainen 2", length(Espoo_Kauniainen_2)),
                                rep("Espoo-Kauniainen 3", length(Espoo_Kauniainen_3)),
                                rep("Helsinki 1", length(Helsinki_1)),
                                rep("Helsinki 2", length(Helsinki_2)),
                                rep("Helsinki 3", length(Helsinki_3)),
                                rep("Helsinki 4", length(Helsinki_4)),
                                rep("Hämeenlinna 1", length(Hameenlinna_1)),
                                rep("Hämeenlinna 2", length(Hameenlinna_2)),
                                rep("Joensuu 1", length(Joensuu_1)),
                                rep("Joensuu 2", length(Joensuu_2)),
                                rep("Joensuu 3", length(Joensuu_3)),
                                rep("Jyväskylä 1", length(Jyvaskyla_1)),
                                rep("Jyväskylä 2", length(Jyvaskyla_2)),
                                rep("Kotka 1", length(Kotka_1)),
                                rep("Kotka 2", length(Kotka_2)),
                                rep("Kuopio 1", length(Kuopio_1)),
                                rep("Kuopio 2", length(Kuopio_2)),
                                rep("Kuopio 3", length(Kuopio_3)),
                                rep("Lahti 1", length(Lahti_1)),
                                rep("Lahti 2", length(Lahti_2)),
                                rep("Lappeenranta 1", length(Lappeenranta_1)),
                                rep("Lappeenranta 2", length(Lappeenranta_2)),
                                rep("Mikkeli 1", length(Mikkeli_1)),
                                rep("Mikkeli 2", length(Mikkeli_2)),
                                rep("Oulu 1", length(Oulu_1)),
                                rep("Oulu 2", length(Oulu_2)),
                                rep("Pori 1", length(Pori_1)),
                                rep("Pori 2", length(Pori_2)),
                                rep("Tampere 1", length(Tampere_1)),
                                rep("Tampere 2", length(Tampere_2)),
                                rep("Tampere 3", length(Tampere_3)),
                                rep("Turku 1", length(Turku_1)),
                                rep("Turku 2", length(Turku_2)),
                                rep("Turku 3", length(Turku_3)),
                                rep("Vantaa 1", length(Vantaa_1)),
                                rep("Vantaa 2", length(Vantaa_2)),
                                rep("Vaasa 1", length(Vaasa_1)),
                                rep("Vaasa 2", length(Vaasa_2))),
                       postinumero = as.character(c(Espoo_Kauniainen_1, Espoo_Kauniainen_2, Espoo_Kauniainen_3, Helsinki_1, Helsinki_2,
                                       Helsinki_3, Helsinki_4, Hameenlinna_1, Hameenlinna_2, Joensuu_1, Joensuu_2, Joensuu_3,
                                       Jyvaskyla_1, Jyvaskyla_2, Kotka_1, Kotka_2, Kuopio_1, Kuopio_2, Kuopio_3,
                                       Lahti_1, Lahti_2, Lappeenranta_1, Lappeenranta_2, Mikkeli_1, Mikkeli_2,
                                       Oulu_1, Oulu_2, Pori_1, Pori_2, Tampere_1, Tampere_2, Tampere_3,
                                       Turku_1, Turku_2, Turku_3, Vantaa_1, Vantaa_2, Vaasa_1, Vaasa_2)))

data <- left_join(aluejako, px_data, by = "Alue")

saveRDS(data, "data/neliovuokra_postinumero.rds")
